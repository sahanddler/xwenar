 <!doctype html>
<html lang="ckb" dir="rtl">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- FAVICON (ADD HERE) -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <title>Ø®ÙˆÛÙ†Û•Ø±</title>
  <link rel="stylesheet" href="style.css" />
    <meta name="description" content="Ú©ØªÛØ¨Ø®Ø§Ù†Û•ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§ÚµÛŒ Ú©ÙˆØ±Ø¯ÛŒ Ø¨Û† Ø®ÙˆÛÙ†Ø¯Ù† Ùˆ ÙÛØ±Ø¨ÙˆÙˆÙ†. Ù‡Û•Ø²Ø§Ø±Ø§Ù† Ú©ØªÛØ¨ Ù„Û• ÛŒÛ•Ú© Ø´ÙˆÛÙ†.">
<meta name="keywords" content="Ú©ØªÛØ¨ØŒ Ú©ÙˆØ±Ø¯ÛŒØŒ Ø®ÙˆÛÙ†Ø¯Ù†ØŒ PDFØŒ Ú©ØªØ§Ø¨ØŒ Kurdish books">
<meta name="author" content="Xwenar Library">
<meta name="robots" content="index, follow">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="topbar">
  <div class="row">
    <div class="brand" onclick="goBack()" style="cursor:pointer;">
      <div class="logo"></div>
      <span id="topTitle">Book</span>
    </div>
    <div class="actions">
      <button class="btn" onclick="goBack()">Ú¯Û•Ú•Ø§Ù†Û•ÙˆÛ•</button>
    </div>
  </div>
</div>

<div class="container">
  <div id="wrap">Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†Ø¨Û•...</div>
</div>

<script src="app.js"></script>
<script>
const file = qs("file");
const id = parseInt(qs("id") || "0", 10);
const name = qs("name") || "Books";
document.getElementById("topTitle").textContent = name;

function goBack(){
  location.href = `category.html?file=${encodeURIComponent(file)}&name=${encodeURIComponent(name)}`;
}

/* ===== Convert Google Drive link to preview ===== */
function drivePreview(url){
  if(!url) return "";
  if(url.includes("drive.google.com")){
    const did = getDriveId(url);
    if(did) return `https://drive.google.com/file/d/${did}/preview`;
  }
  return url;
}

async function load(){
  const wrap = document.getElementById("wrap");

  try{
    const books = await fetchBooks(file);
    const b = books[id];

    if(!b){
      wrap.innerHTML = "<div class='small'>Book not found</div>";
      return;
    }

    /* ğŸ”¥ IMPORTANT FIX (this was the bug) */
    const onlineLink = (b.online && b.online.trim()) ? b.online : "";
    const preview = drivePreview(onlineLink);
    const downloadLink = (b.download && b.download.trim()) ? b.download : "";

    wrap.innerHTML = `
      <div class="details">
        <div class="img">
          <img src="${b.image}"
               loading="lazy"
               decoding="async"
               width="320"
               height="420"
               alt="${b.title}">
        </div>

        <div class="info">
          <div class="h1">${b.title}</div>
          <div class="small">${b.author}</div>

          ${b.description ? `<div class="desc">${b.description}</div>` : ""}

          <div class="cta">
            ${onlineLink ? `<a class="primary" href="${onlineLink}" target="_blank">Ø¨ÛŒÙ†ÛŒÙ†ÛŒ Ø¦Û†Ù†ÚµØ§ÛŒÙ† ğŸ“–</a>` : ""}
            ${downloadLink ? `<a href="${downloadLink}" target="_blank"> Ø¯Ø§Ú¯Ø±ØªÙ† â¬‡ï¸</a>` : ""}
          </div>
        </div>
      </div>

      ${preview ? `
        <div class="section-title">Ø¨ÛŒÙ†ÛŒÙ†ÛŒ Ú•Ø§Ø³ØªÛ•ÙˆØ®Û†</div>
        <div class="viewer">
          <iframe src="${preview}" allow="autoplay" loading="lazy"></iframe>
        </div>
      ` : ""}
    `;

  }catch(err){
    wrap.innerHTML = `<div class="small">Error loading book</div>`;
    console.error(err);
  }
}

load();
</script>
<footer class="footer-modern">
  <div class="footer-wrap">

    <!-- Brand -->
    <div class="footer-col">
      <div class="footer-brand">
        <div class="logo"></div>
        <span>Xwenar</span>
      </div>
      <p class="footer-desc">
        Ú©ØªÛØ¨Ø®Ø§Ù†Û•ÛŒÛ•Ú©ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§ÚµÛŒ Ø¨Û† Ø®ÙˆÛÙ†Ø¯Ù†ØŒ ÙÛØ±Ø¨ÙˆÙˆÙ† Ùˆ Ú¯Û•Ø´Û•Ù¾ÛØ¯Ø§Ù†
      </p>
    </div>

    <!-- Links -->
    <div class="footer-col">
      <h4>Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒ</h4>
      <a href="about-us.html">Ø¯Û•Ø±Ø¨Ø§Ø±Û•ÛŒ Ø¦ÛÙ…Û•</a>
      <a href="contact.html">ÛŒØ§Ø±Ù…Û•ØªÛŒ</a>
      <a href="ku-privacy-policy.html">Ø³ÛŒØ§Ø³Û•ØªÛŒ ØªØ§ÛŒØ¨Û•ØªÛŒ</a>
     </div>

    <!-- Stores -->
    <footer class="footer-modern">
  <div class="footer-wrap">

    <!-- Brand -->
    <div class="footer-col">
      <div class="footer-brand">
        <div class="logo"></div>
        <span>Ø®ÙˆÛÙ†Û•Ø±</span>
      </div>
      <p class="footer-desc">
        Ú©ØªÛØ¨Ø®Ø§Ù†Û•ÛŒÛ•Ú©ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§ÚµÛŒ Ø¨Û† Ø®ÙˆÛÙ†Ø¯Ù†ØŒ ÙÛØ±Ø¨ÙˆÙˆÙ† Ùˆ Ú¯Û•Ø´Û•Ù¾ÛØ¯Ø§Ù†
      </p>
    </div>

    <!-- Stores -->
    <div class="footer-col">
      <h4>Ø¯Ø§Ú¯Ø±ØªÙ†</h4>
      <div class="store-btns">

        <a href="https://play.google.com/store/apps/details?id=com.my.xwenar1&hl=en-US"
           class="store google" target="_blank" aria-label="Google Play">
          <i class="fab fa-google-play"></i>
          <span>Play Store</span>
        </a>

        <a href="https://apps.apple.com/us/app/xwenar/id6751713873"
           class="store apple" target="_blank" aria-label="App Store">
          <i class="fab fa-apple"></i>
          <span>App Store</span>
        </a>

      </div>
    </div>

    <!-- Social -->
    <div class="footer-col">
      <h4>Ø´ÙˆÛÙ†Û•Ú©Ø§Ù†Ù…Ø§Ù†</h4>
      <div class="social-links">

        <a href="https://www.facebook.com/Appxwenar"
           target="_blank" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>

        <a href="https://t.me/sahand_dler"
           target="_blank" aria-label="Telegram">
          <i class="fab fa-telegram-plane"></i>
        </a>

      </div>
    </div>

  </div>

  <div class="footer-bottom">
    Â© 2026 Xwenar Library â€” All rights reserved
  </div>
</footer>

</body>
</html>
